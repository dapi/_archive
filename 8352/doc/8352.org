* Каталог организаций [0/0]
** Грабберы [4/4]																									 :atlancer:
*** DONE 20 ч. businesschr.ru	
*** DONE 30 ч. cheb.ru
*** DONE afisha.cheb.ru
*** DONE adresa.yandex.ru/?region=11156
*** http://www.21rosfirm.ru/
*** http://063.ratiss.org/
*** yell.ru/Чебоксары
*** delpo.ru
*** www.domotido.ru/company
*** kompas21.ru
*** 21.e-adres.ru
** Импорт данных [57%] 																								 :dapi:

	 Нажали на кнопку "автоэкспорт" серве
   р пошуршал и  выдал список категорий
   на определение.  выбрали для каждой к
   атегории из  выпадающего списка нужн
   ую, нажали OK.  Сервер внес необходимы
   е записи в  result_category и поехал экспорт
   ировать.  Если пр инажании на "автоэк
   спорт" не  установленных категорий
	 небыло,
	 то без  вопросов сразу начинается экспорт.
	 
	 * [X] Устанавливаем соответствие категорий по указанному источнику.
   * [X] Выбираем все встречаемые названия категорий и ищем их соответсвия
				 в cat2sourcecat (таблицу надо создать). Если такой записи в cat2sourcecat нет,
				 даем возомжность оператору создать ее.
   * [ ] Множественные категории и предварительное заполнение result_categories
	 * [ ] Ручная доработка
 	  * [ ] непереносимые организации и категории
			 		помечать организации (наверное в results) и категорий (no_follow),
			 		которые автоматически не вносятся в каталог
		* [ ] need_human='t' и attr_freshed если есть поля которые закрыты
			 для обновления (attr_closed)
		* [ ] Автоматическое закрытие поля компании при изменении attr_closed
		* [ ] Вывод повторяющихся компаний (select count(*) from results group by company_id)
		* [ ] pending, Если что помечаем results как нуждающийся в ручной
					обратоке по полу телефонов
		* [ ] Вынести импорт разделов на отдельную страницу
   * [X] Тегирование
	 * [X] 5 ч. [5/5] Импортирование
				 Далее по каждой записи results указанного источника с флагом
				 status=updated
		 * [X] description пополняется из всех результов, если не закрыт
		 * [X] Устанавливаем короткое название, сохраняем его в result.short_name
					 чтобы постоянно не определять. result.short_name=companies.name а result.name=companies.full_name.
					 Можно переименовать в companies чтобы не путаться дальше.
		 * [X] Разбор телефонов
			 1. Парсинг адреса и установка префикса по городу или столице района
			 2. Ведем журнал ошибок импортирования, разбора телефонов для дальнейшего анализа.
		 * [X] Нормализуем адрес в вид: (Индекс) Город, Улица, дом, офис; другой_адрес,
					 сохраняем его в result.normal_addresses
		 * [X] Определяем категорию на основе results_categoreies.
		 * [100%] Добавляем компании:
			 1. [X] по телефону
			 2. [X] полному названию
   * [ ] 4 ч. Тесты
			- [ ] Нормализация адреса
			- [ ] Установка короткого имени
			- [ ] Есть новые категории
			- [ ] Удачно добавляем новую компанию
			- [ ] Удачно изменяем сущесвтующую компанию
			- [ ] Не можем обновить компанию (need_human)
	 
** Пользовательская чать
 	* добавление компании пользователем или админом
*** Рейтинги и отзывы об организации
*** Поиск
*** Добавление компаний пользователем
*** Яндекс-карта
**** Сылка на карту
**** Указание точности
**** Поиск по близлежащим пунктам
**** Метка на карте по категори
**** Рейтингы и комментарии на карте
* backlog
** Запрос данных организации с сайта налоговой
** Буквенный путь, для категорий
** Консультирование по вопросам
** Сквозной форум
** Каталог Веб-сайтов [0/0]
*** Поисковик индексатор
*** Прикрутить к организациям
*** Собственно каталог
** Дизайн
* Задачи на удаленку																								 :remote:
*** DONE Ищем телефоны в поле description														 :victor:
		Проверка: http://dapi.orionet.ru:3000/admin/results/edit/56612
*** DONE Преобразуем address:																				 :victor:
*** DONE Ссылка на яндекс-карту
*** DONE Нормальизация и сокращение имен компаний (short_name и normalized_name)
**** Для short_name удаляем всякие ООО, фирма и тп, оставляем только
		 непосредственное название. Если есть что-то в кавычках - удаляем все
		 и оставляем только это. Имя оставляем в capitalized виде.
**** Для normalized_name хочется видеть предприятия ввиде 
		 ООО "Сфера" или ООО Фирма "Сфера". Само название фирмы (то, что в
     кавычках) = short_name.

*** DONE Множественные категории
    - State "DONE"       from "WAITING"    [2009-09-09 Срд 20:46]
    - State "WAITING"    from "STARTED"    [2009-09-09 Срд 20:46]
		http://github.com/funkensturm/acts_as_category/tree/master
    Несколько категорий может иметь как подкатегория так и ее
    category_content (categorable)
**** [50%] acts_as_multiple_category (для модели Category)
     1. [X] метод класса roots
     2. [ ] исключала зацикливания и существование children-ов без parent-ов.
     3. методы объекта parents, siblings, children, ancestors, descendants, path
     4. Позиционирование категорий (position)
     5. кешировалось количество children-ов, parent-ов, descendants и
				item-ов
**** WAITING acts_as_multiple_categorable (для модели Item)
		 * has_category?(id,string), categories, add_category, remove_category
		 * включать/выключать множественность (валидация)
		 * Установка нескольких категорий
		 * Отключаемая валидация на присутсвие хотябы в одной категории
**** Выбор категорий при создании/редактировании под typus (черз acts_as_tree
**** как-то дружила с acts_as_tree if
		 defined?(ActiveRecord::Acts::Tree)
		 def typus_tree_field(attribute, items = @resource[:class].roots, attribute_virtual = 'parent_id')
		 def expand_tree_into_select_field(items, attribute)
				end
**** DONE Хелпер для отрисовки дерева и его AJAX редактировния :remote:victor:
     - State "DONE"       from "WAITING"    [2009-09-09 Срд 20:46]
     - State "WAITING"    from "STARTED"    [2009-09-09 Срд 20:46]
				1. Перемещать категории вместе с детками
				2. Переименовывать, создавать новые в любом месте
				3. Копировать/Колнировать категорию вместе с детками к другому папочке
					 (установка множественной родительской категории)
				4. +/- для сжатия/расжатия дерева фелеком и его частей.
				5. Контроллер для этого хэлпера
*** DONE parse_phone на строку phones                                :victor:
    - State "DONE"       from "WAITING"    [2009-09-09 Срд 20:46]
    - State "WAITING"    from "STARTED"    [2009-09-09 Срд 20:46]
		
*** DONE Доработка по дереву категорий                               :victor:
**** DONE Стрелки для позиционирования
**** Проблема: при редактировании или сделать AJAX редактирование и категории и группы на месте или запоминать состояние дерева при возврате (может в куки его?)
**** DONE Не удалять группы имеющие компании
**** Категории всегда выводить первее групп
**** неуловимый глюк с зависанием скрипта и размножением групп
**** DONE Придобавлении группы в закрытую категорию категоря не открывается, а группа показывается как якобы единственная в этой категории
*** [100%] Интерфейс к каталогу предприятий (представление компания для пользователя)  :atlancer:
**** DONE Поиск (sphinx)
**** DONE Поля: Наименование, описане, адрес, телефоны (телефоны перед поиском нормализовать)
**** [100%] Список компаний для группы и ветки
***** DONE Постраничный вывод
***** Сортировка по наименованию или адресу (вверх/вниз)
***** Отображение структуры групп/веток
*** Поиск по адресам:
    Так вот, нам надо сделать чтобы можно было:
    - посмотреть список всех домов, найти дом, и посмотреть список
      организаций которые в нем находятся.
    - посмотреть список всех улиц, на улице список ее домой и
      организаций которые на ней находятся.
    - Когда смотришь организацию показывать ее на яндекс-карте (я это
      сделал, но немного сбилось - надо посмотреть почему)
    - Нажимаешь на яндекс-карте на дом, и прыгает на странице этого
      дома с адресами всех компаний.
    - Поиск по адресу через поисковую строку


